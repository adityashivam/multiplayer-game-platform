var g=(t,r)=>()=>(r||t((r={exports:{}}).exports,r),r.exports);var I=g((W,k)=>{"use strict";function R(t,r,e){for(var i=0,n=0,h=e.length;n<h;n++)i=e.charCodeAt(n),i<128?t.setUint8(r++,i):i<2048?(t.setUint8(r++,192|i>>6),t.setUint8(r++,128|i&63)):i<55296||i>=57344?(t.setUint8(r++,224|i>>12),t.setUint8(r++,128|i>>6&63),t.setUint8(r++,128|i&63)):(n++,i=65536+((i&1023)<<10|e.charCodeAt(n)&1023),t.setUint8(r++,240|i>>18),t.setUint8(r++,128|i>>12&63),t.setUint8(r++,128|i>>6&63),t.setUint8(r++,128|i&63))}function V(t){for(var r=0,e=0,i=0,n=t.length;i<n;i++)r=t.charCodeAt(i),r<128?e+=1:r<2048?e+=2:r<55296||r>=57344?e+=3:(i++,e+=4);return e}function l(t,r,e){var i=typeof e,n=0,h=0,a=0,f=0,s=0,o=0;if(i==="string"){if(s=V(e),s<32)t.push(s|160),o=1;else if(s<256)t.push(217,s),o=2;else if(s<65536)t.push(218,s>>8,s),o=3;else if(s<4294967296)t.push(219,s>>24,s>>16,s>>8,s),o=5;else throw new Error("String too long");return r.push({_str:e,_length:s,_offset:t.length}),o+s}if(i==="number")return Math.floor(e)!==e||!isFinite(e)?(t.push(203),r.push({_float:e,_length:8,_offset:t.length}),9):e>=0?e<128?(t.push(e),1):e<256?(t.push(204,e),2):e<65536?(t.push(205,e>>8,e),3):e<4294967296?(t.push(206,e>>24,e>>16,e>>8,e),5):(a=e/Math.pow(2,32)>>0,f=e>>>0,t.push(207,a>>24,a>>16,a>>8,a,f>>24,f>>16,f>>8,f),9):e>=-32?(t.push(e),1):e>=-128?(t.push(208,e),2):e>=-32768?(t.push(209,e>>8,e),3):e>=-2147483648?(t.push(210,e>>24,e>>16,e>>8,e),5):(a=Math.floor(e/Math.pow(2,32)),f=e>>>0,t.push(211,a>>24,a>>16,a>>8,a,f>>24,f>>16,f>>8,f),9);if(i==="object"){if(e===null)return t.push(192),1;if(Array.isArray(e)){if(s=e.length,s<16)t.push(s|144),o=1;else if(s<65536)t.push(220,s>>8,s),o=3;else if(s<4294967296)t.push(221,s>>24,s>>16,s>>8,s),o=5;else throw new Error("Array too large");for(n=0;n<s;n++)o+=l(t,r,e[n]);return o}if(e instanceof Date){var x=e.getTime();return a=Math.floor(x/Math.pow(2,32)),f=x>>>0,t.push(215,0,a>>24,a>>16,a>>8,a,f>>24,f>>16,f>>8,f),10}if(e instanceof ArrayBuffer){if(s=e.byteLength,s<256)t.push(196,s),o=2;else if(s<65536)t.push(197,s>>8,s),o=3;else if(s<4294967296)t.push(198,s>>24,s>>16,s>>8,s),o=5;else throw new Error("Buffer too large");return r.push({_bin:e,_length:s,_offset:t.length}),o+s}if(typeof e.toJSON=="function")return l(t,r,e.toJSON());var u=[],_="",v=Object.keys(e);for(n=0,h=v.length;n<h;n++)_=v[n],typeof e[_]!="function"&&u.push(_);if(s=u.length,s<16)t.push(s|128),o=1;else if(s<65536)t.push(222,s>>8,s),o=3;else if(s<4294967296)t.push(223,s>>24,s>>16,s>>8,s),o=5;else throw new Error("Object too large");for(n=0;n<s;n++)_=u[n],o+=l(t,r,_),o+=l(t,r,e[_]);return o}if(i==="boolean")return t.push(e?195:194),1;if(i==="undefined")return t.push(212,0,0),3;throw new Error("Could not encode")}function F(t){var r=[],e=[],i=l(r,e,t),n=new ArrayBuffer(i),h=new DataView(n),a=0,f=0,s=-1;e.length>0&&(s=e[0]._offset);for(var o,x=0,u=0,_=0,v=r.length;_<v;_++)if(h.setUint8(f+_,r[_]),_+1===s){if(o=e[a],x=o._length,u=f+s,o._bin)for(var M=new Uint8Array(o._bin),C=0;C<x;C++)h.setUint8(u+C,M[C]);else o._str?R(h,u,o._str):o._float!==void 0&&h.setFloat64(u,o._float);a++,f+=x,e[a]&&(s=e[a]._offset)}return n}k.exports=F});var O=g((G,N)=>{"use strict";function p(t){if(this._offset=0,t instanceof ArrayBuffer)this._buffer=t,this._view=new DataView(this._buffer);else if(ArrayBuffer.isView(t))this._buffer=t.buffer,this._view=new DataView(this._buffer,t.byteOffset,t.byteLength);else throw new Error("Invalid argument")}function $(t,r,e){for(var i="",n=0,h=r,a=r+e;h<a;h++){var f=t.getUint8(h);if((f&128)===0){i+=String.fromCharCode(f);continue}if((f&224)===192){i+=String.fromCharCode((f&31)<<6|t.getUint8(++h)&63);continue}if((f&240)===224){i+=String.fromCharCode((f&15)<<12|(t.getUint8(++h)&63)<<6|(t.getUint8(++h)&63)<<0);continue}if((f&248)===240){n=(f&7)<<18|(t.getUint8(++h)&63)<<12|(t.getUint8(++h)&63)<<6|(t.getUint8(++h)&63)<<0,n>=65536?(n-=65536,i+=String.fromCharCode((n>>>10)+55296,(n&1023)+56320)):i+=String.fromCharCode(n);continue}throw new Error("Invalid byte "+f.toString(16))}return i}p.prototype._array=function(t){for(var r=new Array(t),e=0;e<t;e++)r[e]=this._parse();return r};p.prototype._map=function(t){for(var r="",e={},i=0;i<t;i++)r=this._parse(),e[r]=this._parse();return e};p.prototype._str=function(t){var r=$(this._view,this._offset,t);return this._offset+=t,r};p.prototype._bin=function(t){var r=this._buffer.slice(this._offset,this._offset+t);return this._offset+=t,r};p.prototype._parse=function(){var t=this._view.getUint8(this._offset++),r,e=0,i=0,n=0,h=0;if(t<192)return t<128?t:t<144?this._map(t&15):t<160?this._array(t&15):this._str(t&31);if(t>223)return(255-t+1)*-1;switch(t){case 192:return null;case 194:return!1;case 195:return!0;case 196:return e=this._view.getUint8(this._offset),this._offset+=1,this._bin(e);case 197:return e=this._view.getUint16(this._offset),this._offset+=2,this._bin(e);case 198:return e=this._view.getUint32(this._offset),this._offset+=4,this._bin(e);case 199:return e=this._view.getUint8(this._offset),i=this._view.getInt8(this._offset+1),this._offset+=2,[i,this._bin(e)];case 200:return e=this._view.getUint16(this._offset),i=this._view.getInt8(this._offset+2),this._offset+=3,[i,this._bin(e)];case 201:return e=this._view.getUint32(this._offset),i=this._view.getInt8(this._offset+4),this._offset+=5,[i,this._bin(e)];case 202:return r=this._view.getFloat32(this._offset),this._offset+=4,r;case 203:return r=this._view.getFloat64(this._offset),this._offset+=8,r;case 204:return r=this._view.getUint8(this._offset),this._offset+=1,r;case 205:return r=this._view.getUint16(this._offset),this._offset+=2,r;case 206:return r=this._view.getUint32(this._offset),this._offset+=4,r;case 207:return n=this._view.getUint32(this._offset)*Math.pow(2,32),h=this._view.getUint32(this._offset+4),this._offset+=8,n+h;case 208:return r=this._view.getInt8(this._offset),this._offset+=1,r;case 209:return r=this._view.getInt16(this._offset),this._offset+=2,r;case 210:return r=this._view.getInt32(this._offset),this._offset+=4,r;case 211:return n=this._view.getInt32(this._offset)*Math.pow(2,32),h=this._view.getUint32(this._offset+4),this._offset+=8,n+h;case 212:if(i=this._view.getInt8(this._offset),this._offset+=1,i===0){this._offset+=1;return}return[i,this._bin(1)];case 213:return i=this._view.getInt8(this._offset),this._offset+=1,[i,this._bin(2)];case 214:return i=this._view.getInt8(this._offset),this._offset+=1,[i,this._bin(4)];case 215:return i=this._view.getInt8(this._offset),this._offset+=1,i===0?(n=this._view.getInt32(this._offset)*Math.pow(2,32),h=this._view.getUint32(this._offset+4),this._offset+=8,new Date(n+h)):[i,this._bin(8)];case 216:return i=this._view.getInt8(this._offset),this._offset+=1,[i,this._bin(16)];case 217:return e=this._view.getUint8(this._offset),this._offset+=1,this._str(e);case 218:return e=this._view.getUint16(this._offset),this._offset+=2,this._str(e);case 219:return e=this._view.getUint32(this._offset),this._offset+=4,this._str(e);case 220:return e=this._view.getUint16(this._offset),this._offset+=2,this._array(e);case 221:return e=this._view.getUint32(this._offset),this._offset+=4,this._array(e);case 222:return e=this._view.getUint16(this._offset),this._offset+=2,this._map(e);case 223:return e=this._view.getUint32(this._offset),this._offset+=4,this._map(e)}throw new Error("Could not parse")};function B(t){var r=new p(t),e=r._parse();if(r._offset!==t.byteLength)throw new Error(t.byteLength-r._offset+" trailing bytes");return e}N.exports=B});var y=g(E=>{E.encode=I();E.decode=O()});var A=g((K,m)=>{typeof m<"u"&&(m.exports=c);function c(t){if(t)return q(t)}function q(t){for(var r in c.prototype)t[r]=c.prototype[r];return t}c.prototype.on=c.prototype.addEventListener=function(t,r){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(r),this};c.prototype.once=function(t,r){function e(){this.off(t,e),r.apply(this,arguments)}return e.fn=r,this.on(t,e),this};c.prototype.off=c.prototype.removeListener=c.prototype.removeAllListeners=c.prototype.removeEventListener=function(t,r){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var e=this._callbacks["$"+t];if(!e)return this;if(arguments.length==1)return delete this._callbacks["$"+t],this;for(var i,n=0;n<e.length;n++)if(i=e[n],i===r||i.fn===r){e.splice(n,1);break}return e.length===0&&delete this._callbacks["$"+t],this};c.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var r=new Array(arguments.length-1),e=this._callbacks["$"+t],i=1;i<arguments.length;i++)r[i-1]=arguments[i];if(e){e=e.slice(0);for(var i=0,n=e.length;i<n;++i)e[i].apply(this,r)}return this};c.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]};c.prototype.hasListeners=function(t){return!!this.listeners(t).length}});var z=g(U=>{var S=y(),P=A();U.protocol=5;var d=U.PacketType={CONNECT:0,DISCONNECT:1,EVENT:2,ACK:3,CONNECT_ERROR:4},b=Number.isInteger||function(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t},T=function(t){return typeof t=="string"},D=function(t){return Object.prototype.toString.call(t)==="[object Object]"};function L(){}L.prototype.encode=function(t){return[S.encode(t)]};function w(){}P(w.prototype);w.prototype.add=function(t){var r=S.decode(t);this.checkPacket(r),this.emit("decoded",r)};function j(t){switch(t.type){case d.CONNECT:return t.data===void 0||D(t.data);case d.DISCONNECT:return t.data===void 0;case d.CONNECT_ERROR:return T(t.data)||D(t.data);default:return Array.isArray(t.data)}}w.prototype.checkPacket=function(t){var r=b(t.type)&&t.type>=d.CONNECT&&t.type<=d.CONNECT_ERROR;if(!r)throw new Error("invalid packet type");if(!T(t.nsp))throw new Error("invalid namespace");if(!j(t))throw new Error("invalid payload");var e=t.id===void 0||b(t.id);if(!e)throw new Error("invalid packet id")};w.prototype.destroy=function(){};U.Encoder=L;U.Decoder=w});export default z();
